<div class="profile-page">
  <div class="top-bar">
    <div class="left-section">
      <lib-left-buttons></lib-left-buttons>
    </div>
    <div class="right-section">
      <lib-profile-button></lib-profile-button>
    </div>
  </div>
  <div class="profile-container">
    <div class="layout-wrapper">

      <!-- Tab Buttons -->
      <div class="tab-buttons-column">
        <p-button
        label="Details"
        [class]="selectedMenu === 'details' ? 'p-button-primary' : 'p-button-outlined'"
        (click)="selectMenu('details')"
        severity="secondary"
      ></p-button>

      <p-button
        label="Favorites"
        [class]="selectedMenu === 'favorites' ? 'p-button-primary' : 'p-button-outlined'"
        (click)="selectMenu('favorites')"
        severity="secondary"
        ></p-button>

        <p-button
        label="Privacy and data"
        [class]="selectedMenu === 'privacy' ? 'p-button-primary' : 'p-button-outlined'"
        (click)="selectMenu('privacy')"
        severity="secondary"
        ></p-button>
    </div>

    <!-- Content Display -->
    <div class="content-wrapper">
      <!-- DETAILS -->
      <p-card *ngIf="selectedMenu === 'details'" header="Your Profile Details" class="details-card">
        <form [formGroup]="profileForm" class="details-form">

          <div class="form-group">
            <p-float-label variant="on">
              <input pInputText id="firstName" formControlName="firstName" />
              <label for="firstName"><strong>First name</strong></label>
            </p-float-label>
          </div>

          <div class="form-group">
            <p-float-label variant="on">
              <input pInputText id="lastName" formControlName="lastName" />
              <label for="lastName"><strong>Last name</strong></label>
            </p-float-label>
          </div>

          <div class="form-group">
            <p-float-label variant="on">
              <p-datepicker id="birthDate" view="month" dateFormat="mm/yy" [readonlyInput]="true" formControlName="birthDate"></p-datepicker>
              <label for="birthDate"><strong>Birthdate</strong></label>
            </p-float-label>
          </div>

          <div class="form-group">
            <p-float-label variant="on">
              <input pInputText id="email" formControlName="email" />
              <label for="email"><strong>Email</strong></label>
            </p-float-label>
          </div>

          <div class="form-group">
            <p-float-label variant="on">
              <input pInputText id="username" formControlName="username" />
              <label for="username"><strong>Username</strong></label>
            </p-float-label>
          </div>


        </form>

        <div class="changes-btn">
          <p-button label="Delete Account" (click)="deleteAccount()" severity="danger"></p-button>
          <p-button label="Save Changes" (click)="saveChanges()" severity="success"></p-button>
        </div>
      </p-card>

      <!-- FAVORITES -->
      <div *ngIf="selectedMenu === 'favorites'" class="favorites-grid">
        <p-card
        *ngFor="let card of favorites"
        [style]="{ width: '300px', overflow: 'hidden' }"
        >
          <ng-template #header>
            <p-image
            alt="Cocktail card"
            class="image-card"
              [src]="card.image"
              [style]="{ cursor: 'pointer' }"
              width="300"
              [preview]="true"
              (click)="displayCardPage(card.id)"
              >
              <ng-template #indicator>
                <i class="card-indicator">Open</i>
              </ng-template>
            </p-image>
          </ng-template>

          <ng-template #title>
            <div class="title-container">
              <span>{{ card.name }}</span>
              <p-button
              class="fav-button"
              [icon]="card.isFavorite ? 'pi pi-heart-fill' : 'pi pi-heart'"
                [style]="{ color: 'red' }"
                (click)="addToFavorites(card.id); card.isFavorite = !card.isFavorite"
                styleClass="w-full"
                [severity]="'secondary'"
              ></p-button>
            </div>
          </ng-template>

          <ng-template #footer>
            <!-- Optional footer content -->
          </ng-template>
        </p-card>

        <p *ngIf="favorites.length === 0" class="no-fav-message">
          No favorites yet.
        </p>
      </div>

      <div class="paginator" *ngIf="favorites.length > 5 && selectedMenu === 'favorites'">
        <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="rows" [totalRecords]="favorites.length" [rowsPerPageOptions]="rowsPerPageOptions" />
      </div>

      <div class="privacy">
        <!-- PRIVACY AND DATA -->
        <p-card *ngIf="selectedMenu === 'privacy'" header="Privacy and Data" class="privacy-card">
          <p>Manage your privacy settings here.</p>

          <form [formGroup]="profileForm">

            <div class="checkbox-group">
              <div class="checkbox-item">
                <p-checkbox
                inputId="alcoholAllowed"
                formControlName="alcoholAllowed"
                binary="true">
                </p-checkbox>
                <p-fieldset legend="Alcoholic filter" class="checkbox-fieldset">
                  <p class="m-0">
                    Use this filter to control whether cocktails shown include alcohol.
                    Select your preference based on dietary or lifestyle choices.
                    This helps tailor results to your personal consumption settings.
                  </p>
                </p-fieldset>
              </div>

              <div class="checkbox-item">
                <p-checkbox
                inputId="consentProfiling"
                  formControlName="consentProfiling"
                  binary="true">
                </p-checkbox>
                <p-fieldset legend="Profiling consense" class="checkbox-fieldset">
                  <p class="m-0">
                    By consenting to profiling, you allow us to analyze your preferences and behavior.
                    This helps us provide personalized recommendations and improve your experience.
                    You can withdraw your consense at any time.
                  </p>
                </p-fieldset>
              </div>
            </div>
          </form>

          <div class="changes-btn">
            <p-button label="Delete Account" (click)="deleteAccount()" severity="danger"></p-button>
            <p-button label="Save Changes" (click)="saveChanges()" severity="success"></p-button>
          </div>
          </p-card>
        </div>
      </div>
    </div>
  </div>

</div>
